const axios = require('axios');
const fs = require('fs-extra');

function testRandom() {
    let RandomUtils = require('../_utils/RandomUtils');
    console.log(RandomUtils.generateRandom(8, RandomUtils.randomType.number + RandomUtils.randomType.letterUpper));
}

async function testEmail() {
    let EmailUtils = require('../_utils/EmailUtils');
    let emialOps = {
        // fromEmail: 'mmmirana@126.com',
        toEmails: ['420039341@qq.com',],
        ccEmails: ['wrcold520@aliyun.com'],
        bccEmails: ['18166748035@163.com'],
        subject: '某铁辅助插件数据统计',
        text: '您好，欢迎使用某铁辅助插件数据统计！如有疑问请回复信息至本邮箱',
        html: '',
    };
    try {
        let info = await EmailUtils.send(emialOps);
        console.log(JSON.stringify(info));
    } catch (e) {
        console.log(e);
    }
}

// testRandom();
// testEmail()
//
// let dirtydataJson = "[{\"unitproject\":\"融创项目北区1期12#、13#地块3#楼西段\",\"workteam\":\"山西中铁建筑劳务有限公司\",\"wtcheckman\":\"李富泽\",\"troublescore\":0,\"dangerid\":\"000005000002000017000004\",\"titledesc\":\"钢筋机械\",\"attache_type\":0,\"rleaf\":\"0\",\"handleman\":\"李富泽\",\"danger_longname\":\"房建/现场隐患/施工机具/钢筋机械\",\"type\":1,\"danger_level\":\"2\",\"troublename\":\"经检查发现隐患：传动部位未设置防护罩\",\"remark\":\"经检查发现隐患：传动部位未设置防护罩\",\"peoplecount\":2,\"probability\":\"2\",\"belongsort\":\"3\",\"place\":\"2\",\"fntech\":\"1\",\"inoutroad\":\"2\",\"hasworker\":\"1\",\"solutions\":\"1\",\"hasresolvent\":\"及时将发现的隐患问题进行整改，以减少安全事故的发生。\"},{\"unitproject\":\"融创项目北区1期12#、13#地块3#楼西段\",\"workteam\":\"山西中铁建筑劳务有限公司\",\"wtcheckman\":\"李富泽\",\"troublescore\":0,\"dangerid\":\"000005000002000004000008\",\"titledesc\":\"层间防护\",\"attache_type\":0,\"rleaf\":\"0\",\"handleman\":\"李富泽\",\"danger_longname\":\"房建/现场隐患/悬挑式脚手架/层间防护\",\"type\":1,\"danger_level\":\"2\",\"troublename\":\"经检查发现隐患：架体底层未进行封闭\",\"remark\":\"经检查发现隐患：架体底层未进行封闭\",\"peoplecount\":2,\"probability\":\"1\",\"belongsort\":\"3\",\"place\":\"2\",\"fntech\":\"1\",\"inoutroad\":\"2\",\"hasworker\":\"1\",\"solutions\":\"1\",\"hasresolvent\":\"立即将存在的隐患问题进行处理，确保施工生产正常进行。\"},{\"unitproject\":\"融创项目北区1期12#、13#地块3#楼西段\",\"workteam\":\"山西中铁建筑劳务有限公司\",\"wtcheckman\":\"李富泽\",\"troublescore\":0,\"dangerid\":\"000005000002000003000003\",\"titledesc\":\"架体稳定\",\"attache_type\":0,\"rleaf\":\"0\",\"handleman\":\"李富泽\",\"danger_longname\":\"房建/现场隐患/门式钢管脚手架/架体稳定\",\"type\":1,\"danger_level\":\"2\",\"troublename\":\"经检查发现隐患：架体与建筑物结构拉结方式或间距不符合方案要求\",\"remark\":\"经检查发现隐患：架体与建筑物结构拉结方式或间距不符合方案要求\",\"peoplecount\":2,\"probability\":\"2\",\"belongsort\":\"3\",\"place\":\"2\",\"fntech\":\"1\",\"inoutroad\":\"2\",\"hasworker\":\"1\",\"solutions\":\"1\",\"hasresolvent\":\"立即将存在的隐患问题进行处理，确保施工生产正常进行。\"},{\"unitproject\":\"融创项目北区1期12#、13#地块3#楼西段\",\"workteam\":\"山西中铁建筑劳务有限公司\",\"wtcheckman\":\"李富泽\",\"troublescore\":0,\"dangerid\":\"000005000002000012000008\",\"titledesc\":\"开关箱\",\"attache_type\":0,\"rleaf\":\"0\",\"handleman\":\"李富泽\",\"danger_longname\":\"房建/现场隐患/施工用电/开关箱\",\"type\":1,\"danger_level\":\"2\",\"troublename\":\"经检查发现隐患：开关箱漏电保护器额定动作电流大于30mA\",\"remark\":\"经检查发现隐患：开关箱漏电保护器额定动作电流大于30mA\",\"peoplecount\":2,\"probability\":\"2\",\"belongsort\":\"3\",\"place\":\"2\",\"fntech\":\"1\",\"inoutroad\":\"2\",\"hasworker\":\"1\",\"solutions\":\"1\",\"hasresolvent\":\"及时将发现的隐患问题进行整改，以减少安全事故的发生。\"},{\"unitproject\":\"融创项目北区1期12#、13#地块3#楼西段\",\"workteam\":\"山西中铁建筑劳务有限公司\",\"wtcheckman\":\"李富泽\",\"troublescore\":0,\"dangerid\":\"000005000002000014000005\",\"titledesc\":\"钢丝绳、滑轮与对重\",\"attache_type\":0,\"rleaf\":\"0\",\"handleman\":\"李富泽\",\"danger_longname\":\"房建/现场隐患/施工升降机/钢丝绳、滑轮与对重\",\"type\":1,\"danger_level\":\"2\",\"troublename\":\"经检查发现隐患：钢丝绳磨损、变形、锈蚀达到报废标准\",\"remark\":\"经检查发现隐患：钢丝绳磨损、变形、锈蚀达到报废标准\",\"peoplecount\":2,\"probability\":\"1\",\"belongsort\":\"3\",\"place\":\"2\",\"fntech\":\"1\",\"inoutroad\":\"2\",\"hasworker\":\"1\",\"solutions\":\"1\",\"hasresolvent\":\"及时将发现的隐患问题进行整改，以减少安全事故的发生。\"},{\"unitproject\":\"融创项目北区1期12#、13#地块3#楼西段\",\"workteam\":\"山西中铁建筑劳务有限公司\",\"wtcheckman\":\"李富泽\",\"troublescore\":0,\"dangerid\":\"000005000002000002000001\",\"titledesc\":\"构配件材质\",\"attache_type\":0,\"rleaf\":\"0\",\"handleman\":\"李富泽\",\"danger_longname\":\"房建/现场隐患/扣件式钢管脚手架/构配件材质\",\"type\":1,\"danger_level\":\"2\",\"troublename\":\"检查后发现：钢管直径、壁厚、材质不符合要求\",\"remark\":\"检查后发现：钢管直径、壁厚、材质不符合要求\",\"peoplecount\":2,\"probability\":\"2\",\"belongsort\":\"3\",\"place\":\"2\",\"fntech\":\"1\",\"inoutroad\":\"2\",\"hasworker\":\"1\",\"solutions\":\"1\",\"hasresolvent\":\"立即将存在的隐患问题进行处理，确保施工生产正常进行。\"},{\"unitproject\":\"融创项目北区1期12#、13#地块3#楼西段\",\"workteam\":\"山西中铁建筑劳务有限公司\",\"wtcheckman\":\"李富泽\",\"troublescore\":0,\"dangerid\":\"000005000002000019000005\",\"titledesc\":\"灭火器配备\",\"attache_type\":0,\"rleaf\":\"0\",\"handleman\":\"李富泽\",\"danger_longname\":\"房建/现场隐患/临时消防/灭火器配备\",\"type\":1,\"danger_level\":\"2\",\"troublename\":\"经检查发现隐患：可燃材料存放、加工及使用场所未配备灭火器材\",\"remark\":\"经检查发现隐患：可燃材料存放、加工及使用场所未配备灭火器材\",\"peoplecount\":2,\"probability\":\"2\",\"belongsort\":\"3\",\"place\":\"2\",\"fntech\":\"1\",\"inoutroad\":\"2\",\"hasworker\":\"1\",\"solutions\":\"1\",\"hasresolvent\":\"立即将存在的隐患问题进行处理，确保施工生产正常进行。\"},{\"unitproject\":\"融创项目北区1期12#、13#地块3#楼西段\",\"workteam\":\"山西中铁建筑劳务有限公司\",\"wtcheckman\":\"李富泽\",\"troublescore\":0,\"dangerid\":\"000005000002000002000010\",\"titledesc\":\"杆件搭接\",\"attache_type\":0,\"rleaf\":\"0\",\"handleman\":\"李富泽\",\"danger_longname\":\"房建/现场隐患/扣件式钢管脚手架/杆件搭接\",\"type\":1,\"danger_level\":\"2\",\"troublename\":\"检查后发现：纵向水平杆（大横杆）搭接长度小于1m或固定不符合要求\",\"remark\":\"检查后发现：纵向水平杆（大横杆）搭接长度小于1m或固定不符合要求\",\"peoplecount\":2,\"probability\":\"1\",\"belongsort\":\"3\",\"place\":\"2\",\"fntech\":\"1\",\"inoutroad\":\"2\",\"hasworker\":\"1\",\"solutions\":\"1\",\"hasresolvent\":\"立即将存在的隐患问题进行处理，确保施工生产正常进行。\"},{\"unitproject\":\"融创项目北区1期12#、13#地块3#楼西段\",\"workteam\":\"山西中铁建筑劳务有限公司\",\"wtcheckman\":\"李富泽\",\"troublescore\":0,\"dangerid\":\"000005000002000010000001\",\"titledesc\":\"悬挑式卸料钢平台\",\"attache_type\":0,\"rleaf\":\"0\",\"handleman\":\"李富泽\",\"danger_longname\":\"房建/现场隐患/卸料平台/悬挑式卸料钢平台\",\"type\":1,\"danger_level\":\"2\",\"troublename\":\"经检查发现隐患：钢丝绳未设置安全弯\",\"remark\":\"经检查发现隐患：钢丝绳未设置安全弯\",\"peoplecount\":2,\"probability\":\"2\",\"belongsort\":\"3\",\"place\":\"2\",\"fntech\":\"1\",\"inoutroad\":\"2\",\"hasworker\":\"1\",\"solutions\":\"1\",\"hasresolvent\":\"及时将发现的隐患问题进行整改，以减少安全事故的发生。\"},{\"unitproject\":\"融创项目北区1期12#、13#地块3#楼西段\",\"workteam\":\"山西中铁建筑劳务有限公司\",\"wtcheckman\":\"李富泽\",\"troublescore\":0,\"dangerid\":\"000005000002000016000011\",\"titledesc\":\"吊装作业\",\"attache_type\":0,\"rleaf\":\"0\",\"handleman\":\"李富泽\",\"danger_longname\":\"房建/现场隐患/起重吊装/吊装作业\",\"type\":1,\"danger_level\":\"2\",\"troublename\":\"检查后发现：吊索系挂点不符合专项施工方案要求\",\"remark\":\"检查后发现：吊索系挂点不符合专项施工方案要求\",\"peoplecount\":2,\"probability\":\"2\",\"belongsort\":\"3\",\"place\":\"2\",\"fntech\":\"1\",\"inoutroad\":\"2\",\"hasworker\":\"1\",\"solutions\":\"1\",\"hasresolvent\":\"立即将存在的隐患问题进行处理，确保施工生产正常进行。\"},{\"unitproject\":\"融创项目北区1期12#、13#地块3#楼西段\",\"workteam\":\"山西中铁建筑劳务有限公司\",\"wtcheckman\":\"李富泽\",\"troublescore\":0,\"dangerid\":\"000005000002000012000006\",\"titledesc\":\"总配电箱\",\"attache_type\":0,\"rleaf\":\"0\",\"handleman\":\"李富泽\",\"danger_longname\":\"房建/现场隐患/施工用电/总配电箱\",\"type\":1,\"danger_level\":\"2\",\"troublename\":\"经检查发现隐患：总箱未设置漏电保护器\",\"remark\":\"经检查发现隐患：总箱未设置漏电保护器\",\"peoplecount\":2,\"probability\":\"2\",\"belongsort\":\"3\",\"place\":\"2\",\"fntech\":\"1\",\"inoutroad\":\"2\",\"hasworker\":\"1\",\"solutions\":\"1\",\"hasresolvent\":\"立即将存在的隐患问题进行处理，确保施工生产正常进行。\"},{\"unitproject\":\"融创项目北区1期12#、13#地块3#楼西段\",\"workteam\":\"山西中铁建筑劳务有限公司\",\"wtcheckman\":\"李富泽\",\"troublescore\":0,\"dangerid\":\"000005000002000014000005\",\"titledesc\":\"钢丝绳、滑轮与对重\",\"attache_type\":0,\"rleaf\":\"0\",\"handleman\":\"李富泽\",\"danger_longname\":\"房建/现场隐患/施工升降机/钢丝绳、滑轮与对重\",\"type\":1,\"danger_level\":\"2\",\"troublename\":\"检查后发现：滑轮未安装钢丝绳防脱装置\",\"remark\":\"检查后发现：滑轮未安装钢丝绳防脱装置\",\"peoplecount\":2,\"probability\":\"1\",\"belongsort\":\"3\",\"place\":\"2\",\"fntech\":\"1\",\"inoutroad\":\"2\",\"hasworker\":\"1\",\"solutions\":\"1\",\"hasresolvent\":\"及时将发现的隐患问题进行整改，以减少安全事故的发生。\"},{\"unitproject\":\"融创项目北区1期12#、13#地块3#楼西段\",\"workteam\":\"山西中铁建筑劳务有限公司\",\"wtcheckman\":\"李富泽\",\"troublescore\":0,\"dangerid\":\"000005000002000001000003\",\"titledesc\":\"基坑开挖\",\"attache_type\":0,\"rleaf\":\"0\",\"handleman\":\"李富泽\",\"danger_longname\":\"房建/现场隐患/基坑工程/基坑开挖\",\"type\":1,\"danger_level\":\"2\",\"troublename\":\"经检查发现隐患：机械在软土场地作业，未采取铺设渣土、砂石等硬化措施\",\"remark\":\"经检查发现隐患：机械在软土场地作业，未采取铺设渣土、砂石等硬化措施\",\"peoplecount\":2,\"probability\":\"2\",\"belongsort\":\"3\",\"place\":\"2\",\"fntech\":\"1\",\"inoutroad\":\"2\",\"hasworker\":\"1\",\"solutions\":\"1\",\"hasresolvent\":\"立即将存在的隐患问题进行处理，确保施工生产正常进行。\"},{\"unitproject\":\"融创项目北区1期12#、13#地块3#楼西段\",\"workteam\":\"山西中铁建筑劳务有限公司\",\"wtcheckman\":\"李富泽\",\"troublescore\":0,\"dangerid\":\"000005000002000001000007\",\"titledesc\":\"支撑拆除\",\"attache_type\":0,\"rleaf\":\"0\",\"handleman\":\"李富泽\",\"danger_longname\":\"房建/现场隐患/基坑工程/支撑拆除\",\"type\":1,\"danger_level\":\"2\",\"troublename\":\"经检查发现隐患：采用非常规拆除方式不符合国家现行相关规范要求\",\"remark\":\"经检查发现隐患：采用非常规拆除方式不符合国家现行相关规范要求\",\"peoplecount\":2,\"probability\":\"2\",\"belongsort\":\"3\",\"place\":\"2\",\"fntech\":\"1\",\"inoutroad\":\"2\",\"hasworker\":\"1\",\"solutions\":\"1\",\"hasresolvent\":\"及时将发现的隐患问题进行整改，以减少安全事故的发生。\"},{\"unitproject\":\"融创项目北区1期12#、13#地块3#楼西段\",\"workteam\":\"山西中铁建筑劳务有限公司\",\"wtcheckman\":\"李富泽\",\"troublescore\":0,\"dangerid\":\"000005000002000017000001\",\"titledesc\":\"平刨\",\"attache_type\":0,\"rleaf\":\"0\",\"handleman\":\"李富泽\",\"danger_longname\":\"房建/现场隐患/施工机具/平刨\",\"type\":1,\"danger_level\":\"2\",\"troublename\":\"检查后发现：未设置护手安全装置\",\"remark\":\"检查后发现：未设置护手安全装置\",\"peoplecount\":2,\"probability\":\"1\",\"belongsort\":\"3\",\"place\":\"2\",\"fntech\":\"1\",\"inoutroad\":\"2\",\"hasworker\":\"1\",\"solutions\":\"1\",\"hasresolvent\":\"立即将存在的隐患问题进行处理，确保施工生产正常进行。\"},{\"unitproject\":\"融创项目北区1期12#、13#地块3#楼西段\",\"workteam\":\"山西中铁建筑劳务有限公司\",\"wtcheckman\":\"李富泽\",\"troublescore\":0,\"dangerid\":\"000005000002000011000001\",\"titledesc\":\"电梯井承重平台\",\"attache_type\":0,\"rleaf\":\"0\",\"handleman\":\"李富泽\",\"danger_longname\":\"房建/现场隐患/承重平台/电梯井承重平台\",\"type\":1,\"danger_level\":\"2\",\"troublename\":\"经检查发现隐患：平台吊环设置数量少于4个\",\"remark\":\"经检查发现隐患：平台吊环设置数量少于4个\",\"peoplecount\":2,\"probability\":\"1\",\"belongsort\":\"3\",\"place\":\"2\",\"fntech\":\"1\",\"inoutroad\":\"2\",\"hasworker\":\"1\",\"solutions\":\"1\",\"hasresolvent\":\"及时将发现的隐患问题进行整改，以减少安全事故的发生。\"},{\"unitproject\":\"融创项目北区1期12#、13#地块3#楼西段\",\"workteam\":\"山西中铁建筑劳务有限公司\",\"wtcheckman\":\"李富泽\",\"troublescore\":0,\"dangerid\":\"000005000002000006000006\",\"titledesc\":\"安全防护\",\"attache_type\":0,\"rleaf\":\"0\",\"handleman\":\"李富泽\",\"danger_longname\":\"房建/现场隐患/高处作业吊篮/安全防护\",\"type\":1,\"danger_level\":\"2\",\"troublename\":\"检查后发现：吊篮平台周边的防护栏杆设置不符合规范要求\",\"remark\":\"检查后发现：吊篮平台周边的防护栏杆设置不符合规范要求\",\"peoplecount\":2,\"probability\":\"2\",\"belongsort\":\"3\",\"place\":\"2\",\"fntech\":\"1\",\"inoutroad\":\"2\",\"hasworker\":\"1\",\"solutions\":\"1\",\"hasresolvent\":\"立即将存在的隐患问题进行处理，确保施工生产正常进行。\"},{\"unitproject\":\"融创项目北区1期12#、13#地块3#楼西段\",\"workteam\":\"山西中铁建筑劳务有限公司\",\"wtcheckman\":\"李富泽\",\"troublescore\":0,\"dangerid\":\"000005000002000009000004\",\"titledesc\":\"临边防护\",\"attache_type\":0,\"rleaf\":\"0\",\"handleman\":\"李富泽\",\"danger_longname\":\"房建/现场隐患/高处作业/临边防护\",\"type\":1,\"danger_level\":\"2\",\"troublename\":\"经检查发现隐患：临边防护设施的构造、强度不符合规范要求\",\"remark\":\"经检查发现隐患：临边防护设施的构造、强度不符合规范要求\",\"peoplecount\":2,\"probability\":\"1\",\"belongsort\":\"3\",\"place\":\"2\",\"fntech\":\"1\",\"inoutroad\":\"2\",\"hasworker\":\"1\",\"solutions\":\"1\",\"hasresolvent\":\"及时将发现的隐患问题进行整改，以减少安全事故的发生。\"},{\"unitproject\":\"融创项目北区1期12#、13#地块3#楼西段\",\"workteam\":\"山西中铁建筑劳务有限公司\",\"wtcheckman\":\"李富泽\",\"troublescore\":0,\"dangerid\":\"000005000002000017000007\",\"titledesc\":\"气瓶\",\"attache_type\":0,\"rleaf\":\"0\",\"handleman\":\"李富泽\",\"danger_longname\":\"房建/现场隐患/施工机具/气瓶\",\"type\":1,\"danger_level\":\"2\",\"troublename\":\"检查后发现：气瓶未采取防雨防晒通风措施\",\"remark\":\"检查后发现：气瓶未采取防雨防晒通风措施\",\"peoplecount\":2,\"probability\":\"1\",\"belongsort\":\"3\",\"place\":\"2\",\"fntech\":\"1\",\"inoutroad\":\"2\",\"hasworker\":\"1\",\"solutions\":\"1\",\"hasresolvent\":\"及时将发现的隐患问题进行整改，以减少安全事故的发生。\"},{\"unitproject\":\"融创项目北区1期12#、13#地块3#楼西段\",\"workteam\":\"山西中铁建筑劳务有限公司\",\"wtcheckman\":\"李富泽\",\"troublescore\":0,\"dangerid\":\"000005000002000014000009\",\"titledesc\":\"电气安全\",\"attache_type\":0,\"rleaf\":\"0\",\"handleman\":\"李富泽\",\"danger_longname\":\"房建/现场隐患/施工升降机/电气安全\",\"type\":1,\"danger_level\":\"2\",\"troublename\":\"经检查发现隐患：避雷装置不符合规范要求\",\"remark\":\"经检查发现隐患：避雷装置不符合规范要求\",\"peoplecount\":2,\"probability\":\"2\",\"belongsort\":\"3\",\"place\":\"2\",\"fntech\":\"1\",\"inoutroad\":\"2\",\"hasworker\":\"1\",\"solutions\":\"1\",\"hasresolvent\":\"及时将发现的隐患问题进行整改，以减少安全事故的发生。\"}]";
// let dirtydata = JSON.parse(dirtydataJson);
// dirtydata.forEach(function (v, i) {
//     console.log(dirtydata);
// });

async function testHttp() {
    // let url = `http://aqgl.crcc.cn/system/admin/image.jsp?d=${Math.random()}`;
    // let file = 'E:\\workspace\\Webstrom_workspace\\CrccAgent\\web\\_upload\\test.png';
    // axios({
    //     method: 'get',
    //     url: url,
    //     responseType: 'stream'
    // }).then(function (response) {
    //     response.data.pipe(fs.createWriteStream(file))
    // });

    // Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,image/apng,*/*;q=0.8
    // Accept-Encoding: gzip, deflate
    // Accept-Language: zh-CN,zh;q=0.9
    // Connection: keep-alive
    // Cookie: JSESSIONID=abcOvvLi9r_Ke6EPeSDyw; td_cookie=2450390046
    // Host: aqgl.crcc.cn
    // Referer: http://aqgl.crcc.cn/login.do?reqCode=logout
    // Upgrade-Insecure-Requests: 1
    // User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/68.0.3440.75 Safari/537.36

    axios({
        method: 'get',
        url: 'http://aqgl.crcc.cn/login.do?reqCode=logout',
        // url: 'http://werewolf.mcourse.cc/json',
    }).then(function (response) {
        console.log(response.data);
        console.log(response.status);
        console.log(response.statusText);
        console.log(response.headers);
        console.log(response.config);
    })
}

testHttp();